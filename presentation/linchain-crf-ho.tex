{\scriptsize
  \begin{tikzpicture}
    \tikzstyle{xnode}=[rectangle,draw,fill=gray76,minimum size=2em] %
    \tikzstyle{ynode}=[rounded rectangle,draw,fill=gray76,inner sep=1pt,%
    minimum size=2.3em,minimum width=width("MMM|MMM")] %
    \tikzstyle{znode}=[rounded rectangle,fill=none,inner sep=1pt] %
    \tikzstyle{factor}=[rectangle,fill=black,midway,inner sep=0pt,%
    minimum size=0.4em] %

    \node[ynode] (NON0) at (1, 5) {NON|NON};
    \node[ynode] (DOTS0) at (1, 4) {$\ldots$};
    \node[ynode] (SRC0) at (1, 3) {SRC|SNT};
    \node[ynode] (TRG0) at (1, 2) {TRG|SNT};
    \node[ynode] (SNT0) at (1, 1) {SNT|SNT};
    \hyperNodeXX{NON0}{DOTS0}{SRC0}{TRG0}{SNT0}{w$_1$};

    \node[ynode] (NON1) at (3, 5) {NON|NON};
    \node[ynode] (DOTS1) at (3, 4) {$\ldots$};
    \node[ynode] (SRC1) at (3, 3) {SRC|SNT};
    \node[ynode] (TRG1) at (3, 2) {TRG|SNT};
    \node[ynode] (SNT1) at (3, 1) {SNT|SNT};
    \hyperNodeXX{NON1}{DOTS1}{SRC1}{TRG1}{SNT1}{w$_2$};

    \crfFeaturesXX{0/2, 1/3, 2/4}{1}{0};
    %% \node[xnode] (FEAT1) at (2, 0) {};
    %% \node[xnode] (FEAT2) at (3, 0) {};
    %% \node[xnode] (FEAT3) at (4, 0) {};

    %% \path [-] (FEAT1) edge node [factor] {} (SNT1);
    %% \path [-] (FEAT2) edge node [factor] {} (SNT1);
    %% \path [-] (FEAT3) edge node [factor] {} (SNT1);

    \begin{scope}[on background layer]
      \path [-] (NON0.10) edge[] node [factor] {} (NON1.177);
      \path [-] (NON0.350) edge[] node [factor] {} (NON1.185);
      \path [-] (SRC0.340) edge[] node [factor] {} (SNT1.155);
      \path [-] (SRC0.320) edge[] node [factor] {} (SNT1.160);
      \path [-] (TRG0.350) edge[] node [factor] {} (SNT1.165);
      \path [-] (TRG0.335) edge[] node [factor] {} (SNT1.170);
      \path [-] (SNT0.10) edge[] node [factor] {} (SNT1.177);
      \path [-] (SNT0.350) edge[] node [factor] {} (SNT1.185);
    \end{scope}
  \end{tikzpicture}
}
